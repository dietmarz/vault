#!/bin/bash

# Prüft, ob der Dateiname als Argument gegeben wurde
if [ -z "$1" ]; then
    echo "Usage: $0 <file-path>"
    exit 1
fi

FILE_PATH=$1

# Überprüfen, ob die Datei gerade gelöscht und noch nicht zum Index hinzugefügt wurde
if git ls-files --deleted | grep -q "$FILE_PATH"; then
    echo "File is deleted but not yet added to index. Restoring..."
    git checkout -- "$FILE_PATH"

# Überprüfen, ob die Datei zum Index hinzugefügt wurde
elif git ls-files --deleted --cached | grep -q "$FILE_PATH"; then
    echo "File is deleted and added to index. Restoring..."
    git reset HEAD "$FILE_PATH"
    git checkout -- "$FILE_PATH"

# Überprüfen, ob die Datei in früheren Commits existiert und wiederhergestellt werden kann
else
    # Findet den letzten Commit, der die Datei enthielt, und stellt sie wieder her
    LAST_COMMIT=$(git rev-list -n 1 HEAD -- "$FILE_PATH")
    if [ -n "$LAST_COMMIT" ]; then
        echo "File was committed and deleted. Restoring from last commit..."
        git checkout $LAST_COMMIT~1 -- "$FILE_PATH"
    else
        echo "No record of '$FILE_PATH' found in recent commits."
        exit 1
    fi
fi
